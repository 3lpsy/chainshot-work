require("./index.scss");
const server = "http://localhost:3042";
document.getElementById("private-key").addEventListener('input', () => {
  const privKey = document.getElementById("private-key").value;
  privKey = privKey.trim();
  if (privKey.length == 64) {
    const key = ec.keyFromPrivate(privateKey);
    const msgHash = SHA256("VeryUnique");
  } else {
    document.getElementById("signature").innerHTML = "Invalid PrivKey length";
  }
});
document.getElementById("exchange-address").addEventListener('input', ({target: {value}}) => {
  if (value === "") {
    document.getElementById("balance").innerHTML = 0;
    return;
  }
  fetch(`${server}/balance/${value}`).then(response => {
    return response.json();
  }).then(({balance}) => {
    document.getElementById("balance").innerHTML = balance;
  });
});
document.getElementById("transfer-amount").addEventListener('click', () => {
  const sender = document.getElementById("exchange-address").value;
  const amount = document.getElementById("send-amount").value;
  const recipient = document.getElementById("recipient").value;
  const body = JSON.stringify({
    sender,
    amount,
    recipient
  });
  const request = new Request(`${server}/send`, {
    method: 'POST',
    body
  });
  fetch(request, {
    headers: {
      'Content-Type': 'application/json'
    }
  }).then(response => {
    return response.json();
  }).then(({balance}) => {
    document.getElementById("balance").innerHTML = balance;
  });
});
